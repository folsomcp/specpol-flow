<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>specpolFlow Package &mdash; SpecPolFlow 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Sonifying LSD profiles" href="tutorials/LSDsonification_Tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SpecPolFlow
              <img src="_static/final_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Credits.html">Credits</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/OneObservationFlow_Tutorial.html">Using SpecpolFlow: Example <span class="math notranslate nohighlight">\(\xi^1\)</span> CMa (HD 46328)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/LoopFlow_Tutorial.html">Using SpecpolFlow with Multiple Spectra Files: Example <span class="math notranslate nohighlight">\(\xi^1\)</span> CMa (HD 46328)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/CalculateBz_Tutorial.html">Calculating the longitudinal field (Bz) and False Alarm Probability (FAP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/ConvertToSFiles_Tutorial.html">Conversion of telescope-provided files to the standardized .s format</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/ExcludeMaskRegionClass_Tutorial.html">Tutorial on the ExcludeMaskRegion objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/LSDClass_Tutorial.html">Demonstration of the LSD class</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/MaskClass_Tutorial.html">Mask Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/ColabSetup_Tutorial.html">Importing specpolFlow into Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/LSDsonification_Tutorial.html">Sonifying LSD profiles</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">specpolFlow Package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#lsd-class-and-functions">LSD class and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.LSD"><code class="docutils literal notranslate"><span class="pre">LSD</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.calc_bz"><code class="docutils literal notranslate"><span class="pre">LSD.calc_bz()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.calc_fap"><code class="docutils literal notranslate"><span class="pre">LSD.calc_fap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.cog_I"><code class="docutils literal notranslate"><span class="pre">LSD.cog_I()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.cog_IV"><code class="docutils literal notranslate"><span class="pre">LSD.cog_IV()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.cog_V"><code class="docutils literal notranslate"><span class="pre">LSD.cog_V()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.cog_min"><code class="docutils literal notranslate"><span class="pre">LSD.cog_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.fit_gaussian_rv"><code class="docutils literal notranslate"><span class="pre">LSD.fit_gaussian_rv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.norm"><code class="docutils literal notranslate"><span class="pre">LSD.norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.plot"><code class="docutils literal notranslate"><span class="pre">LSD.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.save"><code class="docutils literal notranslate"><span class="pre">LSD.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.scale"><code class="docutils literal notranslate"><span class="pre">LSD.scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.set_weights"><code class="docutils literal notranslate"><span class="pre">LSD.set_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LSD.vshift"><code class="docutils literal notranslate"><span class="pre">LSD.vshift()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.read_lsd"><code class="docutils literal notranslate"><span class="pre">read_lsd()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.run_lsdpy"><code class="docutils literal notranslate"><span class="pre">run_lsdpy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mask-and-excludemaskregion-classes-and-functions">Mask and ExcludeMaskRegion classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.Mask"><code class="docutils literal notranslate"><span class="pre">Mask</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.Mask.clean"><code class="docutils literal notranslate"><span class="pre">Mask.clean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.Mask.get_weights"><code class="docutils literal notranslate"><span class="pre">Mask.get_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.Mask.prune"><code class="docutils literal notranslate"><span class="pre">Mask.prune()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.Mask.save"><code class="docutils literal notranslate"><span class="pre">Mask.save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.read_mask"><code class="docutils literal notranslate"><span class="pre">read_mask()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.ExcludeMaskRegions"><code class="docutils literal notranslate"><span class="pre">ExcludeMaskRegions</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.ExcludeMaskRegions.save"><code class="docutils literal notranslate"><span class="pre">ExcludeMaskRegions.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.ExcludeMaskRegions.to_dict"><code class="docutils literal notranslate"><span class="pre">ExcludeMaskRegions.to_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.read_exclude_mask_regions"><code class="docutils literal notranslate"><span class="pre">read_exclude_mask_regions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.get_Balmer_regions_default"><code class="docutils literal notranslate"><span class="pre">get_Balmer_regions_default()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.get_telluric_regions_default"><code class="docutils literal notranslate"><span class="pre">get_telluric_regions_default()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.make_mask"><code class="docutils literal notranslate"><span class="pre">make_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#spectrum-classes-and-functions">Spectrum classes and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.Spectrum"><code class="docutils literal notranslate"><span class="pre">Spectrum</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.Spectrum.save"><code class="docutils literal notranslate"><span class="pre">Spectrum.save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.read_spectrum"><code class="docutils literal notranslate"><span class="pre">read_spectrum()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#linelist-classe-and-functions">LineList classe and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.LineList"><code class="docutils literal notranslate"><span class="pre">LineList</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specpolFlow.LineList.save"><code class="docutils literal notranslate"><span class="pre">LineList.save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.line_list_zeros"><code class="docutils literal notranslate"><span class="pre">line_list_zeros()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.read_VALD"><code class="docutils literal notranslate"><span class="pre">read_VALD()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.getEffectiveLande"><code class="docutils literal notranslate"><span class="pre">getEffectiveLande()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.estimateLande"><code class="docutils literal notranslate"><span class="pre">estimateLande()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.get_LS_numbers"><code class="docutils literal notranslate"><span class="pre">get_LS_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.get_JJ_numbers"><code class="docutils literal notranslate"><span class="pre">get_JJ_numbers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specpolFlow.get_JK_numbers"><code class="docutils literal notranslate"><span class="pre">get_JK_numbers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SpecPolFlow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">specpolFlow Package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/API.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="specpolflow-package">
<h1>specpolFlow Package<a class="headerlink" href="#specpolflow-package" title="Permalink to this heading"></a></h1>
<section id="lsd-class-and-functions">
<h2>LSD class and functions<a class="headerlink" href="#lsd-class-and-functions" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="specpolFlow.LSD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">LSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specSigI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specSigV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specN1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specSigN1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specN2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specSigN2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD" title="Permalink to this definition"></a></dt>
<dd><p>Holds the LSD profile data.</p>
<p>This usually includes numpy arrays:</p>
<ul class="simple">
<li><p>vel - velocity grid for the LSD profile</p></li>
<li><p>specI - the Stokes I profile</p></li>
<li><p>specSigI - the uncertainties on Stokes I</p></li>
<li><p>specV - the polarization profile, most often Stokes V</p></li>
<li><p>specSigI - the uncertainties on the polarization profile</p></li>
<li><p>specN1 - the Null1 profile</p></li>
<li><p>specSigN1 - the uncertainties on specN1</p></li>
<li><p>specN2 - the Null2 profile, if it exists, otherwise zeros</p></li>
<li><p>specSigN2 - the uncertainties on Null2 if they exist</p></li>
</ul>
<p>And integers:</p>
<ul class="simple">
<li><p>numParam - The number of Stokes I V &amp; Null profiles used (usually 1, 3, or 4)</p></li>
<li><p>npix - the number of pixels (points in velocity) in the LSD profile</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.calc_bz">
<span class="sig-name descname"><span class="pre">calc_bz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'I'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bzwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.calc_bz" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Bz of an LSD profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – lsd object (input). It is assumed that the lsd.vel is in km/s.</p></li>
<li><p><strong>cog</strong> – The value, or calculation method for the center of gravity. The choices are:
‘I’: center of gravity of I,
‘V’: center of gravity of V,
‘IV’: center of gravity of I*V,
a float: a user defined value in km/s.</p></li>
<li><p><strong>norm</strong> – calculation method for the continuum. The choices are:
‘auto’: the median of I outside of velrange (if defined) or the full range (if velrange is not defined)
float: a user defined value to use for Ic.</p></li>
<li><p><strong>lambda0</strong> – wavelength of the transition in nanometer (default=500).
For an LSD profile, this is the lambda value the LSD profile shape was scaled with.</p></li>
<li><p><strong>geff</strong> – effective Lande factor of the transition.
For an LSD profile, this is the geff value the LSD profile shape was scaled with.</p></li>
<li><p><strong>velrange</strong> – range of velocity to use for the determination of the
line center and the continuum. If not defined, the whole range
will be used. If bzwidth is not defined, this range will also be
used for the line Bz calculation.</p></li>
<li><p><strong>bzwidth</strong> – distance from the line center to use in the Bz calculation.
One element = same on each side of line center.
Two elements, left and right of line center.
Not defined: using velrange.</p></li>
<li><p><strong>plot</strong> – whether or not a graph is generated, and returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a dictionary with Bz (in G) and FAP calculations,
optionally a matplotlib figure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.calc_fap">
<span class="sig-name descname"><span class="pre">calc_fap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.calc_fap" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to return the V, null1, and null2 FAP for a given LSD object</p>
<p>The False Alarm Probability (FAP) is the probability that the observed
data are consistent with the null hypothesis of no magnetic field.
In this case, the null hypothesis is a flat line in Stokes V
(an offset from 0 is allowed to account for continuum polarization).
The probability is evaluated from chi^2.</p>
<p>If you would like a specific range in velocity, simply slice the LSD object beforehand. 
Note that the calcBz function also returns the FAP inside the spectral line, 
over the same velocity range as used in the Bz calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> – LSD object (input)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FAP V, FAP N1, FAP N2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.cog_I">
<span class="sig-name descname"><span class="pre">cog_I</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.cog_I" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to return the center of gravity of a Stokes I LSD profile, 
for a given continuum level (default =1.0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – LSD object</p></li>
<li><p><strong>Ic</strong> – (float, default=1.0) the continnum level to use the the COG calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.cog_IV">
<span class="sig-name descname"><span class="pre">cog_IV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.cog_IV" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to return the center of gravity of a (Stokes I)*(Stoke V) for a LSD profile, 
for a given continuum level (default =1.0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – LSD object</p></li>
<li><p><strong>Ic</strong> – (float, default=1.0) the continnum level to use the the COG calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.cog_V">
<span class="sig-name descname"><span class="pre">cog_V</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.cog_V" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to return the center of gravity of a Stokes V LSD profile,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> – LSD object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.cog_min">
<span class="sig-name descname"><span class="pre">cog_min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.cog_min" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to return the velocity of the minimum of a Stokes I profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> – a LSD object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.fit_gaussian_rv">
<span class="sig-name descname"><span class="pre">fit_gaussian_rv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotFit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullOutput</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaleErrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.fit_gaussian_rv" title="Permalink to this definition"></a></dt>
<dd><p>Fit a Gaussian function to this LSD profile, to determine a radial velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>velrange</strong> – Range of velocity to fit include in the fit
(a tuple or list with 2 elements).
If not given, the whole range will be used.</p></li>
<li><p><strong>plotFit</strong> – If True, Plot the fit to the LSD profile with matplotlib.</p></li>
<li><p><strong>fullOutput</strong> – If True, Return all the Gaussian best fit parameters,
rather than just the RV and RV error</p></li>
<li><p><strong>scaleErrs</strong> – If True scale the errors on the fitting parameters by
the square root of the reduced chi^2</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of best fit RV and RV error. If fullOutput is True then also
includes continuum &amp; error, amplitude &amp; error, and width &amp; error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normValue</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.norm" title="Permalink to this definition"></a></dt>
<dd><p>Return a renormalize an LSD profile, divide the I, V, and null profiles by a value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>normValue</strong> – the value to renormalize (divide) the LSD profile by</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#specpolFlow.LSD" title="specpolFlow.LSD">LSD</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sameYRange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotZeroLevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the LSD profile</p>
<p>This generates a matplotlib figure. To display the figure, after
running this function, use ‘import matplotlib.pyplot as plt’ and
‘plt.show()’. To save the figure you can use 
‘fig.savefig(“fileName.pdf”)’ on the new figure object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> – the size of the figure being created</p></li>
<li><p><strong>sameYRange</strong> – optionally set the Stokes V and Null plots to have the same y scale</p></li>
<li><p><strong>plotZeroLevel</strong> – optionally include a dashed line at 0 for the V and Null plots.</p></li>
<li><p><strong>fig</strong> – optional, a matplotlib figure used for plotting the LSD 
profile. By default (or if None) a new figure will be generated.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>returns an fig, ax matplotlib container.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.save" title="Permalink to this definition"></a></dt>
<dd><p>Save the LSD profile to a file.</p>
<p>This saves to a text file in Donati’s format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the name of the file the LSD profile to save to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_pol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.scale" title="Permalink to this definition"></a></dt>
<dd><p>Return a LSD profile with rescaled amplitudes of the LSD profile (see also set_weights())</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale_int</strong> – scale the intensity profile by this</p></li>
<li><p><strong>scale_pol</strong> – scale the polarization and null profiles by this</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lsd object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.set_weights">
<span class="sig-name descname"><span class="pre">set_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wint_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpol_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wint_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wpol_new</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.set_weights" title="Permalink to this definition"></a></dt>
<dd><p>Change the weight of the LSD profile (see also scale())</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wint_old</strong> – The current intensity weight (d)</p></li>
<li><p><strong>wpol_old</strong> – The current polarization weight (g*d*lambda)</p></li>
<li><p><strong>wint_new</strong> – The new intensity weight (d)</p></li>
<li><p><strong>wpol_new</strong> – The new polarization weight (g*d*lambda)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>lsd object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LSD.vshift">
<span class="sig-name descname"><span class="pre">vshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velShift</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LSD.vshift" title="Permalink to this definition"></a></dt>
<dd><p>Return a LSD profile with a shift to the velocities of the LSD profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>velShift</strong> – the change in velocity to be added</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#specpolFlow.LSD" title="specpolFlow.LSD">LSD</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.read_lsd">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">read_lsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.read_lsd" title="Permalink to this definition"></a></dt>
<dd><p>function that reads in a LSD profile.</p>
<p>The LSD profiles are in Donati’s text format.
The two lines of header in Donati’s format is optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the name of the file containing the LSD profile</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>returns an instance of the LSD class, defined in this module</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.run_lsdpy">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">run_lsdpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prof.dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velStart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velEnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velPixel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normDepth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normLande</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normWave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">removeContPol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trimMask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaClipIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaClip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpMode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outModelName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fLSDPlotImg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fSavePlotImg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outPlotImgName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.run_lsdpy" title="Permalink to this definition"></a></dt>
<dd><p>Run the LSDpy code and return an LSD object.
(A convenience wrapper around the lsdpy.main() function.)</p>
<p>Any arguments not specified will be read from the file inlsd.dat.
The file inlsd.dat is optional, but if the file dose not exist and 
any arguments are ‘None’, the program will error and halt.
Some arguments have default values, which will be used if they are not
explicitly specified and if the inlsd.dat file is missing.</p>
<p>Arguments are:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – name of the input observed spectrum file</p></li>
<li><p><strong>mask</strong> – name of the input LSD mask file</p></li>
<li><p><strong>outName</strong> – name of the output LSD profile (Default = ‘prof.dat’)</p></li>
<li><p><strong>velStart</strong> – float, starting velocity for the LSD profile (km/s)</p></li>
<li><p><strong>velEnd</strong> – float, ending  velocity (km/s)</p></li>
<li><p><strong>velPixel</strong> – float, velocity pixel size (km/s)</p></li>
<li><p><strong>normDepth</strong> – float, normalizing line depth</p></li>
<li><p><strong>normLande</strong> – float, normalizing effective Lande factor</p></li>
<li><p><strong>normWave</strong> – float, normalizing wavelength</p></li>
<li><p><strong>removeContPol</strong> – int, flag for whether continuum polarization is 
subtracted from the LSD profile (0=no, 1=yes)
(Default = 1)</p></li>
<li><p><strong>trimMask</strong> – int, flag for whether very closely spaced lines 
should be removed from the line mask (0=no, 1=yes)
(Default = 0)</p></li>
<li><p><strong>sigmaClipIter</strong> – int, number of iterations for sigma clipping, 
rejecting possible bad pixels based on the fit to
Stokes I. Set to 0 for no sigma clipping.
(Default = 0, no sigma clipping)</p></li>
<li><p><strong>sigmaClip</strong> – float, if sigma clipping, reject pixels where the
observation differs from the model by more than this
number of sigma.  Should be a large value so only very
bad pixels are rejected.
(Default = 500.)</p></li>
<li><p><strong>interpMode</strong> – int, mode for interpolating the model on to the
observation during LSD 0 = nearest neighbour,
1 = linear interpolation.
(Default = 1)</p></li>
<li><p><strong>outModelName</strong> – name of the file for the output model spectrum 
(if saved). If this is ‘’ a model 
will be generated but not saved to file.
(Default = ‘’)</p></li>
<li><p><strong>fLSDPlotImg</strong> – int, flag for whether to plot the LSD profile
(using matplotlib) (0=no, 1=yes)
(Default = 1)</p></li>
<li><p><strong>fSavePlotImg</strong> – int, flag for whether to save the plot of the 
LSD profile (0=no, 1=yes)
(Default = 0)</p></li>
<li><p><strong>outPlotImgName</strong> – name of the plotted figure of the LSD profile 
(if saved) (Default = ‘figProf.pdf’)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns an LSD profile object.  Also the model spectrum (the fit
to the observation, i.e. the convolution of the line
mask and LSD profile), inside an ‘Spectrum’ object.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="mask-and-excludemaskregion-classes-and-functions">
<h2>Mask and ExcludeMaskRegion classes and functions<a class="headerlink" href="#mask-and-excludemaskregion-classes-and-functions" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="specpolFlow.Mask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">Mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lande</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iuse</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.Mask" title="Permalink to this definition"></a></dt>
<dd><p>The data for the LSD line Mask.</p>
<p>This usually contains arrays:</p>
<ul class="simple">
<li><p>wl - wavelengths of lines</p></li>
<li><p>element - the element+ion code for the line</p></li>
<li><p>depth - the depth of the line</p></li>
<li><p>lande - the effective Lande factor of the line</p></li>
<li><p>iuse - integer flag for whether the line is used</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.Mask.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.Mask.clean" title="Permalink to this definition"></a></dt>
<dd><p>Use a ExcludeMaskRegions object and returns a Mask Object in which
set the iuse column is set to zero for
for spectral lines with wavelengths in these regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>regions</strong> – An ExcludeMaskRegions object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.Mask.get_weights">
<span class="sig-name descname"><span class="pre">get_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normDepth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normWave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normLande</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.Mask.get_weights" title="Permalink to this definition"></a></dt>
<dd><p>Returns the calculated the LSD weights of all the lines in the mask
(no matter if iuse is 0 or 1).</p>
<p>This assumes the Stokes I lines are weighted as depth,
and Stokes V is weighted as depth*wavelength*Lande factor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normDepth</strong> – the normalizing line depth for the mask/LSD profile</p></li>
<li><p><strong>normWave</strong> – the normalizing wavelength (nm) for the mask/LSD profile</p></li>
<li><p><strong>normLande</strong> – the normalizing effective Lande factor for the mask/LSD profile</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>weightI, weightV</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.Mask.prune">
<span class="sig-name descname"><span class="pre">prune</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.Mask.prune" title="Permalink to this definition"></a></dt>
<dd><p>Return a Mask object with unused lines removed from the Mask.</p>
<p>Remove lines if iuse index is set to 0,
restricting the Mask to only lines used in LSD.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.Mask.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.Mask.save" title="Permalink to this definition"></a></dt>
<dd><p>Save the line Mask to a text file, in Donati’s and LSDpy format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the file name to output the Mask to.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.read_mask">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">read_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.read_mask" title="Permalink to this definition"></a></dt>
<dd><p>Read in an LSD line mask file and returns a Mask object.</p>
<p>The mask file should one line of header and columns of:
* Wavelength (nm)
* Atomic number + (ionization state)*0.01
* Line depth
* Excitation potential of the lower level (eV)
* Effective Lande factor
* Flag for whether the line is used (1=use, 0=skip).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the name of the file to read.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#specpolFlow.Mask" title="specpolFlow.Mask">Mask</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="specpolFlow.ExcludeMaskRegions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">ExcludeMaskRegions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.ExcludeMaskRegions" title="Permalink to this definition"></a></dt>
<dd><p>Class for a region object that records spectral regions to exclude from a Mask.</p>
<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.ExcludeMaskRegions.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.ExcludeMaskRegions.save" title="Permalink to this definition"></a></dt>
<dd><p>Save the ExcludeMaskRegions object to a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the file path/name</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.ExcludeMaskRegions.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.ExcludeMaskRegions.to_dict" title="Permalink to this definition"></a></dt>
<dd><p>Function to return the ExcludeMaskRegion as a dictionary. 
This is useful to transform ExcludeMaskRegions objects to Panda dataframes</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.read_exclude_mask_regions">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">read_exclude_mask_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.read_exclude_mask_regions" title="Permalink to this definition"></a></dt>
<dd><p>Read in a ExcludeMaskRegion file into an ExcludeMaskRegion object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the path/name of the file</p>
</dd>
<dt class="field-even">Rtype ExcludeMaskRegion<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.get_Balmer_regions_default">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">get_Balmer_regions_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">velrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.get_Balmer_regions_default" title="Permalink to this definition"></a></dt>
<dd><p>Returns a ExcludeMaskRegion object with regions around Balmer H-lines (alpha to epsilon) 
up to a given radial velocity, and a region that exclude the Balmer jump (from 360-392 nm)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>velrange</strong> – (default 500 km/s) velocity range around the H-line to be excluded.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ExcludeMaskRegion</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.get_telluric_regions_default">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">get_telluric_regions_default</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.get_telluric_regions_default" title="Permalink to this definition"></a></dt>
<dd><p>Returns a ExcludeMaskRegions object with regions with heavy telluric regions in the optical</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.make_mask">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lineListFile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskFile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depthCutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wlStart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wlEnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landeStart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landeEnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elementsUsed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elementsExclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomsOnly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includeNoLande</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defaultLande</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.make_mask" title="Permalink to this definition"></a></dt>
<dd><p>Generate an LSD line mask from a VALD line list and save it.
The main interface for generating new line masks with Python scrips.</p>
<p>This generates an LSD line mask from atomic lines in the list,
and estimates Lande factors for lines where possible.  Lines that 
no Lande factor can be estimated for are omitted by default.
This assumes input line list wavelengths in A, and returns a mask in nm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lineListFile</strong> – The name of the file containing the line list</p></li>
<li><p><strong>maskFile</strong> – The name of the to write the mask to</p></li>
<li><p><strong>depthCutoff</strong> – Only include lines in the mask deeper than this value (defaults to 0, all lines included)</p></li>
<li><p><strong>wlStart</strong> – Optionally, only use lines with wavelengths above this (note: value in nm!)</p></li>
<li><p><strong>wlEnd</strong> – Optionally, only use lines with wavelengths below this (note: value in nm!)</p></li>
<li><p><strong>landeStart</strong> – Optionally, only use lines with effective Lande factors above this</p></li>
<li><p><strong>landeEnd</strong> – Optionally, only use lines with effective Lande factors below this</p></li>
<li><p><strong>elementsUsed</strong> – Optionally, provide a list of elements to include in the line mask. This should be a list of strings with the element symbols, e.g. [‘C’, ‘O’, ‘Si’, ‘Fe’] (an empty list or a list starting with ‘all’ will include all elements)</p></li>
<li><p><strong>elementsExclude</strong> – Optionally, provide a list of elements to exclude from the line mask. Also a list of strings with the element symbols.</p></li>
<li><p><strong>atomsOnly</strong> – Only include atomic lines (no molecular lines) and exclude H lines (defaults to True)</p></li>
<li><p><strong>includeNoLande</strong> – Include lines in the mask even if no Lande factor can be estimated for them (defaults to False)</p></li>
<li><p><strong>defaultLande</strong> – The value of the effective Lande factor to use if no value can be estimated (only used if includeNoLande = True)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The mask object, in case further processing is desired</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="spectrum-classes-and-functions">
<h2>Spectrum classes and functions<a class="headerlink" href="#spectrum-classes-and-functions" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="specpolFlow.Spectrum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">Spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specV</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specN1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specN2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specSig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.Spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Contains an observed spectrum, usually spectropolarimetric data.</p>
<p>Usually contains arrays:</p>
<ul class="simple">
<li><p>wl - wavelengths</p></li>
<li><p>specI - Stokes I spectrum</p></li>
<li><p>specV - polarized spectrum, usually Stokes V</p></li>
<li><p>specN1 - the first polarimetric null spectrum</p></li>
<li><p>specN2 - the second polarimetric null spectrum</p></li>
<li><p>specSig - the formal uncertainties, which apply to the other spectra</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.Spectrum.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveHeader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.Spectrum.save" title="Permalink to this definition"></a></dt>
<dd><p>Write the Spectrum into a .s LibreESPRIT style format
Optionally skip writing the two lines of header</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>saveHeader</strong> – optional flag to skip writing the header if False</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.read_spectrum">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">read_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trimBadPix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortByWavelength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.read_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Read in the observed spectrum and save it.</p>
<p>This follows the .s format from Donati’s LibreESPRIT,
files can either have two lines of header or no header.
This supports 6 column spectropolarimetric files
(wavelength, I, V|Q|U, null1, null2, errors),
and also 3 column spectra (wavelength, I, errors).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – the name of the file to read.</p></li>
<li><p><strong>sortByWavelength</strong> – reorder the points in the spectrum to always
increase in wavelength, if set to True.</p></li>
<li><p><strong>trimBadPix</strong> – optionally remove the more obviously bad pixels if True.
Removes pixels with negative flux or error bars of zero,
pixels within 3sigma of zero (large error bars),
and pixels with extremely large values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a Spectrum object containing the observation.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="linelist-classe-and-functions">
<h2>LineList classe and functions<a class="headerlink" href="#linelist-classe-and-functions" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="specpolFlow.LineList">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">LineList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loggf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Elo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Jlo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Jup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landeLo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landeUp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landeEff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stark</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configLo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configUp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LineList" title="Permalink to this definition"></a></dt>
<dd><p>Container for a set of spectral line data, usually from VALD.</p>
<p>This usually contains:</p>
<ul class="simple">
<li><p>nLines - number of lines in the line list</p></li>
<li><p>ion - list of species identifiers (element or molecule and ionization)</p></li>
<li><p>wl - array of wavelengths</p></li>
<li><p>loggf - array of oscillator strengths (log gf)</p></li>
<li><p>Elo - array of excitation potentials for the lower level in the transition (in eV)</p></li>
<li><p>Jlo - array of J quantum numbers for the lower level</p></li>
<li><p>Eu - array of excitation potentials for the upper level in the transition (in eV)</p></li>
<li><p>Jup - array of J quantum numbers for the upper level</p></li>
<li><p>landeLo - array of Lande factors for the lower level</p></li>
<li><p>landeUp - array of Lande factors for the upper level</p></li>
<li><p>landeEff - array of effective Lande factors for the transition</p></li>
<li><p>rad - array of radiative damping coefficients</p></li>
<li><p>stark - array of quadratic Stark damping coefficients</p></li>
<li><p>waals - array of van der Waals damping coefficients</p></li>
<li><p>depth - depth at the centre of the spectral line, as estimated by VALD</p></li>
<li><p>configLo - list of strings with the electron configuration and term symbols for the lower level</p></li>
<li><p>configUp - list of strings with the electron configuration and term symbols for the upper level</p></li>
<li><p>refs - list of references for the sources of the line data (optional)</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="specpolFlow.LineList.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.LineList.save" title="Permalink to this definition"></a></dt>
<dd><p>Write a line list to a text file.
This outputs using the VALD version 3 ‘extract stellar’ ‘long’ format.</p>
<p>A few details (e.g. references) are omitted since they are not saved
in the LineList class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the file name to save the output to</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.line_list_zeros">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">line_list_zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nLines</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.line_list_zeros" title="Permalink to this definition"></a></dt>
<dd><p>Generate a line list of zeros and blank text.</p>
<p>Used by read_VALD (It can be a bit faster to allocate all the array space at once)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nLines</strong> – the number of lines in the LineList of zeros</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#specpolFlow.LineList" title="specpolFlow.LineList">LineList</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.read_VALD">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">read_VALD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.read_VALD" title="Permalink to this definition"></a></dt>
<dd><p>Read a list of spectral line data from VALD and return a LineList</p>
<p>This expects VALD version 3 line list, in an ‘extract stellar’ ‘long’ format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fname</strong> – the file name for the VALD line list.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>LineList object, containing arrays of line data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.getEffectiveLande">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">getEffectiveLande</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">landeLo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landeUp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Jlo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Jup</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.getEffectiveLande" title="Permalink to this definition"></a></dt>
<dd><p>Calculate an effective Lande factor for a transition.</p>
<p>This uses the upper and lower level Lande factors and J quantum numbers.
The effective Lande factor is similar to an average weighted by the
splitting pattern of the line.  It parameterizes the displacement of
the centre of gravity of the sigma components of a Zeeman split line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>landeLo</strong> – Lower level Lande factor</p></li>
<li><p><strong>landeUp</strong> – Upper level Lande factor</p></li>
<li><p><strong>Jlo</strong> – Lower level J quantum number</p></li>
<li><p><strong>Jup</strong> – Upper level J quantum number</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Effective Lande factor for the transition</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.estimateLande">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">estimateLande</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.estimateLande" title="Permalink to this definition"></a></dt>
<dd><p>Estimate a Lande factor for a level (if VALD doesn’t have one)</p>
<p>This supports levels in LS coupling, JJ coupling, and JK coupling.
Levels in LK coupling are not supported.  This relies on VALD3’s text 
format for electron term symbols and configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>J</strong> – The J quantum number for this level</p></li>
<li><p><strong>config</strong> – The text string from VALD with the electron configuration
and term symbol for the level</p></li>
<li><p><strong>verbose</strong> – Report warnings for levels in unsupported coupling schemes if True</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The Lande factor estimated for this level.  If the Lande factor can’t be estimated this will be 99.0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.get_LS_numbers">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">get_LS_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.get_LS_numbers" title="Permalink to this definition"></a></dt>
<dd><p>Extract the L and S quantum numbers from a VALD term symbol text string,
for a level in LS coupling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – the electron configuration and term symbol text string</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The L and S quantum numbers (if a parsing error occurs, negative values are returned)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.get_JJ_numbers">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">get_JJ_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.get_JJ_numbers" title="Permalink to this definition"></a></dt>
<dd><p>Extract the L1, S1, J1, L2, S2, and J2 quantum numbers for a level in JJ 
coupling from VALD’s electron configuration and term symbol text string.</p>
<p>This should cover the J1-J2 case (where two subgroups combine to produce
J1 and J2, which combine to produce the total J), the J1-j case (where
one subgroup makes J1, which combines with an additional electron with j
combines to produce J), and it should work for the j-j case (for two
equivalent electrons with their own j, which combine to make J).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – the electron configuration and term symbol text string</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The L1, S1, J1, L2, S2, and J2 quantum numbers (if a parsing error occurs, negative values are returned)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="specpolFlow.get_JK_numbers">
<span class="sig-prename descclassname"><span class="pre">specpolFlow.</span></span><span class="sig-name descname"><span class="pre">get_JK_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#specpolFlow.get_JK_numbers" title="Permalink to this definition"></a></dt>
<dd><p>Extract the L1, S1, J1, L2, S2, and K quantum numbers for a level in JK
coupling from VALD’s electron configuration and term symbol text string.</p>
<p>This is sometimes called J1-l or J1-L2 coupling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – the electron configuration and term symbol text string</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The L1, S1, J1, L2, S2, and K quantum numbers (if a parsing error occurs, negative values are returned)</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorials/LSDsonification_Tutorial.html" class="btn btn-neutral float-left" title="Sonifying LSD profiles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The SpecPolFlow team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>